<!DOCTYPE html>

<html>
<head>
  <title>dombuilder.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>dombuilder.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>For all code examples below, please assume that we’ve done the following aliasing — just to keep things a little less verbose.</p>
<pre><code><span class="hljs-comment">// Assign to shorter variables.</span>
<span class="hljs-keyword">var</span> _ = DOMBuilder, $body = <span class="hljs-built_in">document</span>.body;
$body.a = $body.appendChild;
</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="digging-into-code">Digging into code</h2>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Do everything in a localized scope. We’ll expose pieces to the global scope later.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>;(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">
    'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="dombuilder">DOMBuilder</h2>
<p>Accepts a string representation of a tag name for the element parameter, and a JSON hash of key-value
pairs for the attributes parameter. Returns a self-reference to this by default. Provides methods,
described below. You can easily shorten this function name by assigning it to a variable.</p>
<pre><code><span class="hljs-comment">// Longer-form</span>
$body.a(_.DOM(
    _(<span class="hljs-string">'p'</span>, {
        <span class="hljs-string">'id'</span>:<span class="hljs-string">'abc'</span>,
        <span class="hljs-string">'class'</span>:[<span class="hljs-string">'def'</span>, <span class="hljs-string">'ghi'</span>]
    })
));

<span class="hljs-comment">// or...</span>

<span class="hljs-comment">// Shorter-form</span>
$body.a(_.DOM(
    _(<span class="hljs-string">'p#abc.def.ghi'</span>)
));
</code></pre><p>This <code>X</code> variable will be exposed to the global scope as <code>DOMBuilder</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
    <span class="hljs-keyword">var</span> X = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">elem, attr</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Internally to DOMBuilder, we use very short variable names so that we can squeeze the file size
down as small as possible using Uglify.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> _ = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>;
        <span class="hljs-keyword">var</span> dotHashRe = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-regexp">/[\.#]/</span>);
        <span class="hljs-keyword">var</span> eqRe = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-regexp">/\[([^\]]*)\]/g</span>);
        <span class="hljs-keyword">var</span> key;
        <span class="hljs-keyword">var</span> k;
        <span class="hljs-keyword">var</span> match;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Set a default internal value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        attr = attr || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Support CSS/jQuery-style notation for generating elements with IDs, classnames, and simple attributes.</p>
<pre><code>div#myId
p#id.class1.class2
a[href=https://google.com]
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        function notation() {

            if (!dotHashRe.test(elem) &amp;&amp; !eqRe.test(elem)) {
                return {};
            }

            var att = {
                class: [],
                id: ''
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Collect all of the <code>[k=v]</code> blocks.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> kvPair = [];
            <span class="hljs-keyword">while</span> ((match = eqRe.exec(elem)) !== <span class="hljs-literal">null</span>) {
                kvPair.push(match[<span class="hljs-number">1</span>].split(<span class="hljs-string">'='</span>));
            }
            elem = elem.replace(eqRe, <span class="hljs-string">''</span>);

            kvPair.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val, idx, arr</span>) </span>{
                att[arr[idx][<span class="hljs-number">0</span>]] = arr[idx][<span class="hljs-number">1</span>];
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Support CSS/jQuery-style notation for generating elements with IDs and classnames.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> pieces = elem.split(dotHashRe);
            <span class="hljs-keyword">var</span> elemType = pieces.shift();
            <span class="hljs-keyword">var</span> pos = elemType.length;
            <span class="hljs-keyword">var</span> classes = att[<span class="hljs-string">'class'</span>];

            pieces.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val, idx, arr</span>) </span>{
                <span class="hljs-keyword">if</span> (elem[pos] === <span class="hljs-string">'#'</span>) {
                    att.id = val;
                } <span class="hljs-keyword">else</span> {
                    classes.push(val);
                }

                pos += arr[idx].length + <span class="hljs-number">1</span>;
            });

            att[<span class="hljs-string">'class'</span>] = classes;
            <span class="hljs-keyword">if</span> (!att[<span class="hljs-string">'class'</span>].length) {
                <span class="hljs-keyword">delete</span> att[<span class="hljs-string">'class'</span>];
            }
            <span class="hljs-keyword">if</span> (att[<span class="hljs-string">'id'</span>] === <span class="hljs-string">''</span>) {
                <span class="hljs-keyword">delete</span> att[<span class="hljs-string">'id'</span>];
            }

            <span class="hljs-keyword">return</span> att;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Merge the properties of one object with the properties of a second object. (Internal-only!)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeOptions</span>(<span class="hljs-params">o1, o2</span>) </span>{

            <span class="hljs-keyword">var</span> o3 = {},
                attrname;

            <span class="hljs-keyword">for</span> (attrname <span class="hljs-keyword">in</span> o1) {
                <span class="hljs-keyword">if</span> (o1.hasOwnProperty(attrname)) {
                    o3[attrname] = o1[attrname];
                }
            }

            <span class="hljs-keyword">for</span> (attrname <span class="hljs-keyword">in</span> o2) {
                <span class="hljs-keyword">if</span> (o2.hasOwnProperty(attrname)) {
                    o3[attrname] = o2[attrname];
                }
            }

            <span class="hljs-keyword">return</span> o3;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Merge options into a conglomo-hash!</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        attr = mergeOptions(attr, notation());</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Construct the element, loop through the list of attributes and add them to the node.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (dotHashRe.test(elem)) {
            _.e = d.createElement(elem.split(dotHashRe).shift());
        } <span class="hljs-keyword">else</span> {
            _.e = d.createElement(elem);
        }

        <span class="hljs-keyword">if</span> (attr) {
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> attr) {
                <span class="hljs-keyword">if</span> (attr.hasOwnProperty(key)) {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> attr[key] === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> attr[key].length === <span class="hljs-string">'number'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> attr[key].splice === <span class="hljs-string">'function'</span>) {
                        attr[key] = attr[key].join(<span class="hljs-string">' '</span>);
                    }</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Because of the way that IE works, class names need to be added explicitly via the <code>.className</code>
property instead of using <code>.setAttribute()</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (key.toString() === <span class="hljs-string">'class'</span>) {
                        _.e.className = attr[key];</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Support <code>data: {}</code> for data attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key.toString() === <span class="hljs-string">'data'</span>) {
                            <span class="hljs-keyword">for</span> (k <span class="hljs-keyword">in</span> attr[key]) {
                                <span class="hljs-keyword">if</span> (attr[key].hasOwnProperty(k)) {
                                    _.e.setAttribute(<span class="hljs-string">'data-'</span> + k, attr[key][k]);
                                }
                            }
                        } <span class="hljs-keyword">else</span> {
                            _.e.setAttribute(key, attr[key]);
                        }
                }
            }
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <h3 id="-child-or-_-">.child() or ._()</h3>
<p>The <code>child()</code> method is used to add children to a parent node, or to add a new tag to a
text string. Accepts one or more child nodes in the form of a <code>DOMBuilder</code> object or a native
<code>HTMLElement</code> node (created with <code>document.createElement()</code>). Multiple child nodes are passed as an
array of objects. Returns a self-reference to <code>this</code> by default.</p>
<pre><code>$body.a(_.DOM(
    _(<span class="hljs-string">'p#abc.def'</span>)._([
        _(<span class="hljs-string">'strong'</span>).H(<span class="hljs-string">'This is bold text.'</span>),
        _(<span class="hljs-string">'em'</span>).H(<span class="hljs-string">'This is italic text.'</span>)
    ])
));
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        _.child = _._ = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>If the object isn’t an array, convert it to an array to maintain a single codepath below.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span> || <span class="hljs-keyword">typeof</span> obj.length !== <span class="hljs-string">'number'</span> || <span class="hljs-keyword">typeof</span> obj.splice !== <span class="hljs-string">'function'</span>) {
                obj = [obj];
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Loop through the indexed array of children. If the node is a <code>DOMBuilder</code> object, convert it to
DOM and append it. Otherwise, assume it’s a real DOM node.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, max = obj.length; i &lt; max; i++) {

                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[i] === <span class="hljs-string">'undefined'</span>) {
                    <span class="hljs-keyword">break</span>;
                }

                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[i].asDOM !== <span class="hljs-string">'undefined'</span>) {
                    _.e.appendChild(obj[i].asDOM());
                } <span class="hljs-keyword">else</span> {
                    _.e.appendChild(obj[i]);
                }
            }

            <span class="hljs-keyword">return</span> _;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <h3 id="-html-or-h-">.html() or .H()</h3>
<p>The <code>html()</code> method is used for adding text or HTML content to a node. Since it leverages <code>.innerHTML</code>
under the hood, you can pass a string of content to the text parameter. The default behavior is to
append content.</p>
<p>If you’d prefer to replace the existing <code>.innerHTML</code> content instead, pass a boolean <code>true</code> to the
<code>replace</code> parameter. Returns a self-reference to <code>this</code> by default.</p>
<p>Pass no parameters to read back the node as a string of HTML.</p>
<pre><code>$body.a(_.DOM(
    _(<span class="hljs-string">'p#abc.def'</span>)._([
        _(<span class="hljs-string">'strong'</span>).H(<span class="hljs-string">'This is bold text.'</span>),
        _(<span class="hljs-string">'em'</span>).H(<span class="hljs-string">'This is italic text.'</span>)
    ])
    .H(<span class="hljs-string">'Replace the previous nodes with this text'</span>, <span class="hljs-literal">true</span>)
));

_(<span class="hljs-string">'p#abc.def'</span>)._([
    _(<span class="hljs-string">'strong'</span>).H(<span class="hljs-string">'This is bold text.'</span>),
    _(<span class="hljs-string">'em'</span>).H(<span class="hljs-string">'This is italic text.'</span>)
]).html()
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        _.html = _.H = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, replace</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>No parameters? Read the value instead. Alias for asHTML().</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> _.asHTML();
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Determine the default value for <code>replace</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            replace = replace || <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Set the value with innerHTML.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (replace) {
                _.e.innerHTML = str;
            } <span class="hljs-keyword">else</span> {
                _.e.innerHTML += str;
            }

            <span class="hljs-keyword">return</span> _;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h3 id="-text-or-t-">.text() or .T()</h3>
<p>The <code>text()</code> method is used for adding plain text content to a node. Since it leverages <code>.textContent</code>
or <code>.innerText</code> under the hood, you can pass a string of content to the text parameter. The default
behavior is to append content.</p>
<p>If you’d prefer to replace the existing content instead, pass a boolean <code>true</code> to the <code>replace</code>
parameter. Returns a self-reference to <code>this</code> by default.</p>
<p>Pass no parameters to read back the node as a string of plain text.</p>
<pre><code>$body.a(_.DOM(
    _(<span class="hljs-string">'p#abc.def'</span>)._([
        _(<span class="hljs-string">'strong'</span>).H(<span class="hljs-string">'This is bold text.'</span>),
        _(<span class="hljs-string">'em'</span>).H(<span class="hljs-string">'This is italic text.'</span>)
    ])
    .T(<span class="hljs-string">'Replace the previous nodes with this text'</span>, <span class="hljs-literal">true</span>)
));

_(<span class="hljs-string">'p#abc.def'</span>)._([
    _(<span class="hljs-string">'strong'</span>).H(<span class="hljs-string">'This is bold text.'</span>),
    _(<span class="hljs-string">'em'</span>).H(<span class="hljs-string">'This is italic text.'</span>)
]).text()
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        _.text = _.T = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>No parameters? Read the value instead. Alias for asText().</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> _.asText();
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Set the value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (_.e.innerText) {
                _.e.innerText = str;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> text = <span class="hljs-built_in">document</span>.createTextNode(str);
                _.e.appendChild(text);
            }

            <span class="hljs-keyword">return</span> _;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h3 id="-asdom-or-dom-">.asDOM() or .dom()</h3>
<p>Returns a real DOM node for use with the standard JavaScript DOM methods. When DOMBuilder objects
are passed to the child method, <code>asDOM()</code> is optional. It is only required when it’s the last method
in the chain while being passed into a real JavaScript DOM node.</p>
<pre><code>$body.a(
    _(<span class="hljs-string">'p#abc.def'</span>)._([
        _(<span class="hljs-string">'strong'</span>).H(<span class="hljs-string">'This is bold text.'</span>),
        _(<span class="hljs-string">'em'</span>).H(<span class="hljs-string">'This is italic text.'</span>)
    ]).dom()
);
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        _.asDOM = _.dom = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> _.e;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <h3 id="-ashtml-or-html-or-h-">.asHTML() or .html() or .H()</h3>
<p>Returns the DOM nodes as a string of HTML. It’s as simple as that.</p>
<pre><code><span class="hljs-keyword">var</span> id = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'id'</span>);
id.innerHTML = _(<span class="hljs-string">'p#abc.def'</span>).H(<span class="hljs-string">'This is my text.'</span>).asHTML();
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        _.asHTML = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> t = d.createElement(<span class="hljs-string">'div'</span>);
            t.appendChild(_.e);
            <span class="hljs-keyword">return</span> t.innerHTML;
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <h3 id="-astext-or-text-or-t-">.asText() or .text() or .T()</h3>
<p>Returns the DOM nodes as a string of plain text. It’s as simple as that.</p>
<pre><code><span class="hljs-keyword">var</span> id = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'id'</span>);
id.innerHTML = _(<span class="hljs-string">'p#abc.def'</span>).H(<span class="hljs-string">'This is my text.'</span>).asText();
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>        _.asText = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> t = d.createElement(<span class="hljs-string">'div'</span>);
            t.appendChild(_.e);

            <span class="hljs-keyword">if</span> (t.innerText) {
                <span class="hljs-keyword">return</span> t.innerText;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t.textContent) {
                <span class="hljs-keyword">return</span> t.textContent;
            }
        };

        <span class="hljs-keyword">return</span> _;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <h2 id="expose-to-the-global-scope">Expose to the global scope</h2>
<p>Pre-instantiate the class on each call so that you never need to use <code>new</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-built_in">window</span>.DOMBuilder = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">elem, attr</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X(elem, attr);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h2 id="dom-">DOM()</h2>
<p>This is the function that all other <code>DOMBuilder</code> nodes are passed into, as it returns directly into the
<code>appendChild()</code> method. For a single <code>DOMBuilder</code> chain, this is interchangable with the <code>.asDOM()</code>
method (although they’re used differently).</p>
<p>If you are passing in multiple sibling nodes without a parent, <code>DOM()</code> leverages
<a href="http://ejohn.org/blog/dom-documentfragments/">Document Fragments</a> to substantially speed up the process
of writing multiple nodes to the live DOM.</p>
<pre><code>$body.a(_.DOM([
    _(<span class="hljs-string">'p#abc.def'</span>).H(<span class="hljs-string">'This is my text.'</span>),
    _(<span class="hljs-string">'p'</span>).H(<span class="hljs-string">'Something simpler.'</span>),
    _(<span class="hljs-string">'p'</span>).H(<span class="hljs-string">'Let\'s add a third paragraph, for kicks.'</span>)
]));
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-built_in">window</span>.DOMBuilder.DOM = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nodes</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Create a document fragment. Grab and loop through the in-memory DOM nodes, and <em>move</em> them to the</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        <span class="hljs-keyword">var</span> f = <span class="hljs-built_in">document</span>.createDocumentFragment(),
            n = <span class="hljs-keyword">new</span> X(<span class="hljs-string">'div'</span>)._(nodes).dom().childNodes;

        <span class="hljs-keyword">while</span> (n.length) {
            f.appendChild(n[<span class="hljs-number">0</span>]);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Return the Document Fragment to the calling method (presumably <code>.appendChild()</code>).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">return</span> f;
    };
})();</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
